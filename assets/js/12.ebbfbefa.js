(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{341:function(t,a,s){"use strict";s.r(a);var v=s(3),_=Object(v.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("p",[t._v("使用消息队列的三个经典场景，"),a("strong",[t._v("异步")]),t._v("，"),a("strong",[t._v("削峰")]),t._v("，"),a("strong",[t._v("解耦")]),t._v("。")]),t._v(" "),a("h2",{attrs:{id:"异步"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#异步"}},[t._v("#")]),t._v(" 异步")]),t._v(" "),a("p",[t._v("就比如下单业务，对于用户而言，流程很短，下完单就完成。但是对于系统后端来说，可能流程，执行链路很长。导致用户就会存在着偏差，明明这么简单一个事情，系统给我反应这么慢。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://lzh-images.oss-cn-hangzhou.aliyuncs.com/images/image-20230227094056897.png",alt:"image-20230227094056897"}})]),t._v(" "),a("p",[t._v("可以将业务拆分开，将一些没有顺序的流程同时做，也就是异步操作。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://lzh-images.oss-cn-hangzhou.aliyuncs.com/images/image-20230227094600901.png",alt:"image-20230227094600901"}})]),t._v(" "),a("h2",{attrs:{id:"解耦"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#解耦"}},[t._v("#")]),t._v(" 解耦")]),t._v(" "),a("p",[t._v("既然是将这些流程同时做，但是不能采用多线程来做。这么多业务要调用这么多接口，全部写在一块出现问题了也不好后期维护，流程中某一点出问题，又会影响到其它独立的点。")]),t._v(" "),a("p",[t._v("用了消息队列，耦合这个问题就迎刃而解了。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://lzh-images.oss-cn-hangzhou.aliyuncs.com/images/image-20230227100059491.png",alt:"image-20230227100059491"}})]),t._v(" "),a("p",[t._v("下单完成了，就把支付成功的消息告诉别的系统取处理，他们收到了去处理就好了。后面要接入什么系统，只需要监听这个消息即可。")]),t._v(" "),a("h2",{attrs:{id:"削峰"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#削峰"}},[t._v("#")]),t._v(" 削峰")]),t._v(" "),a("p",[t._v("把请求放到队列里面，然后至于每秒消费多少请求，就看自己的"),a("strong",[t._v("服务器处理能力")]),t._v("，可能会慢一点，但不至于服务器挂了。")]),t._v(" "),a("h2",{attrs:{id:"缺点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#缺点"}},[t._v("#")]),t._v(" 缺点")]),t._v(" "),a("h3",{attrs:{id:"系统复杂性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#系统复杂性"}},[t._v("#")]),t._v(" 系统复杂性")]),t._v(" "),a("p",[t._v("本来一个简单系统好好的，现在弄了一个中间件，还要维护它，消息"),a("strong",[t._v("重复消费")]),t._v("、"),a("strong",[t._v("消息丢失")]),t._v("、"),a("strong",[t._v("消息的顺序消费")]),t._v("。")]),t._v(" "),a("h3",{attrs:{id:"数据一致性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据一致性"}},[t._v("#")]),t._v(" 数据一致性")]),t._v(" "),a("p",[t._v("下单服务自己保证自己的逻辑成果处理了，成果发送了消息，但是其它系服务，成不成功得不到保证，所有服务都成功才算一次下单成功。")]),t._v(" "),a("p",[a("strong",[t._v("分布式事务")]),t._v("：把下单，优惠券，积分。。。都放在一个事务里面一样，要成功一起成功，要失败一起失败。")]),t._v(" "),a("h3",{attrs:{id:"可用性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#可用性"}},[t._v("#")]),t._v(" 可用性")]),t._v(" "),a("p",[t._v("中间件毕竟是第三方软件，这个进程有可能挂了的风险。")])])}),[],!1,null,null,null);a.default=_.exports}}]);