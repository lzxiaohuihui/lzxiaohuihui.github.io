(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{367:function(s,t,a){"use strict";a.r(t);var n=a(3),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"展示"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#展示"}},[s._v("#")]),s._v(" 展示")]),s._v(" "),t("p",[s._v("首页")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://lzh-images.oss-cn-hangzhou.aliyuncs.com/images/image-20230904172056046.png",alt:"image-20230904172056046"}})]),s._v(" "),t("p",[s._v("关注")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://lzh-images.oss-cn-hangzhou.aliyuncs.com/images/image-20230904172339998.png",alt:"image-20230904172339998"}})]),s._v(" "),t("p",[s._v("通知")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://lzh-images.oss-cn-hangzhou.aliyuncs.com/images/image-20230904171905526.png",alt:"image-20230904171905526"}})]),s._v(" "),t("p",[s._v("自习室")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://lzh-images.oss-cn-hangzhou.aliyuncs.com/images/image-20230904172026029.png",alt:"image-20230904172026029"}})]),s._v(" "),t("p",[s._v("个人主页")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://lzh-images.oss-cn-hangzhou.aliyuncs.com/images/image-20230904171643857.png",alt:"image-20230904171643857"}})]),s._v(" "),t("h2",{attrs:{id:"主要实现"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#主要实现"}},[s._v("#")]),s._v(" 主要实现")]),s._v(" "),t("h3",{attrs:{id:"发帖子"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#发帖子"}},[s._v("#")]),s._v(" 发帖子")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://lzh-images.oss-cn-hangzhou.aliyuncs.com/images/image-20230904172523896.png",alt:"image-20230904172523896"}})]),s._v(" "),t("p",[s._v("对于粉丝不多的用户，发布一条帖子，写入帖子表，同时写入MQ。")]),s._v(" "),t("p",[s._v("消费者异步推送到粉丝的收件箱表，后续粉丝查看关注的帖子时，从该收件箱表中取出帖子ID。写放大，后续考虑结合，结合读扩散方式。")]),s._v(" "),t("div",{staticClass:"language-sql extra-class"},[t("pre",{pre:!0,attrs:{class:"language-sql"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("create")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("table")]),s._v(" post\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    id          "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("varchar")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("               "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("not")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("null")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("comment")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'主键'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    title       "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("varchar")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("255")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("''")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("not")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("null")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("comment")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'标题'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    content     "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("longtext")]),s._v("                  "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("null")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("comment")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'markdown内容'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    user_id     "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("varchar")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("20")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("               "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("not")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("null")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("comment")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'作者ID'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    comments    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v("          "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("not")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("null")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("comment")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'评论统计'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    collects    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v("          "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("not")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("null")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("comment")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'收藏统计'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("view")]),s._v("        "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v("          "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("not")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("null")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("comment")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'浏览统计'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("top")]),s._v("         "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("bit")]),s._v("          "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" b"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'0'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("not")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("null")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("comment")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'是否置顶，1-是，0-否'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    essence     "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("bit")]),s._v("          "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" b"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'0'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("not")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("null")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("comment")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'是否加精，1-是，0-否'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    section_id  "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v("          "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("null")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("comment")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'专栏ID'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    create_time "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("datetime")]),s._v("                  "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("not")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("null")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("comment")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'发布时间'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    modify_time "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("datetime")]),s._v("                  "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("null")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("comment")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'修改时间'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n    like_number "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("int")]),s._v("          "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("not")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("null")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("comment")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'被点赞数量'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("comment")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'帖子表'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("charset")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" utf8mb3\n                     row_format "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" DYNAMIC"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("create")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("index")]),s._v(" create_time\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" post "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("create_time"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("create")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("index")]),s._v(" user_id\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("on")]),s._v(" post "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("user_id"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n\n")])])]),t("p",[s._v("收件箱表box类似")]),s._v(" "),t("h3",{attrs:{id:"查帖子"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查帖子"}},[s._v("#")]),s._v(" 查帖子")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://lzh-images.oss-cn-hangzhou.aliyuncs.com/images/image-20230904205818008.png",alt:"image-20230904205818008"}})]),s._v(" "),t("p",[s._v("采用Redis存储一些额外信息，采用Redis String的方式存储一些热点的帖子，以及点赞关系，帖子-标签为多对多关系，方便查询，使用正向和反向list存储。")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("post_i: [tag1, tag2, ...]\ntag_i: [post1, post2, ...]\n")])])]),t("p",[s._v("标签表，以及帖子话题关系表")]),s._v(" "),t("h3",{attrs:{id:"点赞-关注"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#点赞-关注"}},[s._v("#")]),s._v(" 点赞/关注")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://lzh-images.oss-cn-hangzhou.aliyuncs.com/images/image-20230904211345011.png",alt:"image-20230904211345011"}})]),s._v(" "),t("p",[s._v("采用异步的方式，写入MQ就算操作成功。")]),s._v(" "),t("p",[s._v("对于高并发")]),s._v(" "),t("p",[s._v("前面扩展可以多节点处理请求。")]),s._v(" "),t("p",[s._v("后面扩展可以增加消费者，并且多线程消费。对于计数来说，可以统一更改。")]),s._v(" "),t("h3",{attrs:{id:"自习室"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#自习室"}},[s._v("#")]),s._v(" 自习室")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://lzh-images.oss-cn-hangzhou.aliyuncs.com/images/image-20230904215007056.png",alt:"image-20230904215007056"}})]),s._v(" "),t("p",[s._v("暂时，相当于是一个全站的时长排行榜。")]),s._v(" "),t("p",[s._v("将前端vue项目打包成Electron桌面程序后，可以采用Node.js提供的Python环境来执行Python脚本。当登录后，开始统计桌面窗口信息，与服务器建立Socket连接，将窗口信息发送到服务器。")]),s._v(" "),t("p",[s._v("数据存储，采用InfluxDB，格式如下")]),s._v(" "),t("p",[s._v("statistic, running_time, app user_id, time")]),s._v(" "),t("p",[s._v("排行榜信息，采用Redis中的Zset存储，set中值为userName，得分该user今天的运行时长")]),s._v(" "),t("p",[s._v("排行榜定时任务每十分钟刷新一次，将InfluxDB中近十分钟数据取出来，更新Zset中的得分")]),s._v(" "),t("h3",{attrs:{id:"个人时间统计"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#个人时间统计"}},[s._v("#")]),s._v(" 个人时间统计")]),s._v(" "),t("p",[s._v("对于不同的数据，再代码中分割好不同的查询条件，进行多次查询。")])])}),[],!1,null,null,null);t.default=e.exports}}]);